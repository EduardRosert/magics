C (C) Copyright 1996-2016 ECMWF.
C 
C This software is licensed under the terms of the Apache Licence Version 2.0
C which can be obtained at http://www.apache.org/licenses/LICENSE-2.0. 
C In applying this licence, ECMWF does not waive the privileges and immunities 
C granted to it by virtue of its status as an intergovernmental organisation nor
C does it submit to any jurisdiction.
C

      PROGRAM CONT10
C
C     THIS PROGRAM DEMONSTRATES MAGICS CONTOURING FACILITIES.
C     CONTOUR LINES ARE GENERATED BY USING DIFFERENT CONTOURING
C     METHODS: LINEAR (DIRECT CONTOUR THREADING) AND CONICON (SEAMED QUADRATIC ELEMENT)
C     THE METEOROLOGICAL DATA FIELD IS A STANDARD GLOBAL MSL PRESSURE FIELD.
C     COASTLINES ARE PROJECTED ONTO A POLAR STEREOGRAPHIC MAP.
C     'CONTOUR_METHOD' IS SET TO 'CONICON' OR 'LINEAR' TO TELL MAGICS
C     WHICH CONTOURING METHODS IS TO BE USED.
C
C     OPEN MAGICS
C
      CALL POPEN
      CALL PSETC ('PS_DEVICE','ps_a4')
      CALL PSETC ('PS_FILE_NAME','cont10.ps')
      CALL PSETC ('PAGE_ID_LINE_USER_TEXT','TESTS/CONT10')
C
C     SET COMMON MAGICS PARAMETERS FOR THIS PLOT
C
      CALL PSETC ('SUBPAGE_MAP_PROJECTION','POLAR_STEREOGRAPHIC')
      CALL PSETC ('SUBPAGE_MAP_AREA_DEFINITION','CENTRE')
      CALL PSETC ('MAP_COASTLINE_LAND_SHADE','ON')
      CALL PSETC ('MAP_COASTLINE_LAND_SHADE_COLOUR','CREAM')
      CALL PSETC ('MAP_COASTLINE_COLOUR','CREAM')
      CALL PSETC ('MAP_GRID_COLOUR','BLACK')
      CALL PSETC ('MAP_GRID_LINE_STYLE', 'DOT')
C
C     PASS THE DATA TO MAGICS
C
      CALL PSETC ('GRIB_SUBAREA_EXTRACTION','OFF')
      CALL PSETC ('GRIB_INPUT_TYPE', 'FILE')
      CALL PSETC ('GRIB_INPUT_FILE_NAME',
     x  'data/oldts/msl.grb')
      CALL PGRIB
      CALL PSETC ('TEXT_LINE_1',
     1    'Polar Stereographic Northern Hemisphere - MSL Field ')
      CALL PSETI ('TEXT_LINE_COUNT',2)
      CALL PSETC ('TEXT_JUSTIFICATION', 'CENTRE')
      CALL PSETR ('TEXT_REFERENCE_CHARACTER_HEIGHT',0.4)
C
C     PLOT CONTOUR LINES IN NORTHERN HEMISPHERE (CONICON)
C
      CALL CONT10_ONE
      CALL PNEW('PAGE')
C
C     PLOT SAME AREA (LINEAR)
C
      CALL CONT10_TWO
      CALL PNEW('PAGE')
C
C     PLOT CONTOURS ON SELECTED EUROPEAN AREA (CONICON)
C
      CALL CONT10_THREE
      CALL PNEW('PAGE')
C
C     PLOT CONTOURS ON EUROPEAN AREA (LINEAR)
C
      CALL CONT10_FOUR
      CALL PNEW('PAGE')
C
C     PLOT CONTOURS ON SMALLER REGION (CONICON)
C
      CALL CONT10_FIVE
      CALL PNEW('PAGE')
C
C     PLOT CONTOURS ON SAME REGION (LINEAR) 
C
      CALL CONT10_SIX
C
C     CLOSE MAGICS
C
      CALL PCLOSE
      END
      SUBROUTINE CONT10_ONE
C
C     THIS SUBROUTINE PLOTS CONTOURS AND COASTLINES ON FULL
C     NORTHERN HEMISPHERE. THE CONTOURS ARE PROJECTED FROM A GLOBAL
C     GAUSSIAN GRID ONTO THE POLAR STEREOGRAPHIC AREA.
C     CONTOURING METHOD 'CONICON' IS USED (DEFAULT) AND CONTOUR LINES
C     ARE PLOTTED AT 5 hPa INTERVALS.
C
      CALL PSETC ('CONTOUR_LEVEL_SELECTION_TYPE','INTERVAL')
      CALL PSETR ('CONTOUR_INTERVAL',5.0)
      CALL PSETR ('CONTOUR_HILO_SUPPRESS_RADIUS', 45.0)
C
C     PLOT THE COASTLINES AND CONTOURS
C
      CALL PCOAST
      CALL PCONT
C
C     PLOT THE TEXT
C
      CALL PSETC ('TEXT_LINE_2',
     1            'Contouring Method is CONICON')
      CALL PTEXT
C
      RETURN
      END
      SUBROUTINE CONT10_TWO
C
C     THIS SUBROUTINE PLOTS CONTOURS FROM THE GLOBAL GAUSSIAN
C     MSL FIELD ON THE SAME REGION AND PROJECTION. CONTOURING
C     METHOD 'LINEAR' IS USED.
C
      CALL PSETC ('CONTOUR_METHOD','LINEAR')
C
C     PLOT THE COASTLINES AND CONTOURS
C
      CALL PCOAST
      CALL PCONT
C
C     PLOT THE TEXT
C
      CALL PSETC ('TEXT_LINE_1',
     1    'Polar Stereographic Northern Hemisphere - MSL Field ')
      CALL PSETI ('TEXT_LINE_COUNT',2)
      CALL PSETC ('TEXT_LINE_2',
     1            'Contouring Method is LINEAR')
      CALL PTEXT
C
      RETURN
      END





      SUBROUTINE CONT10_THREE
C
C     THIS ROUTINE PLOTS MSL CONTOUR LINES ON A SELECTED POLAR
C     STEREOGRAPHIC AREA WITH MAP CENTRE OF (52.0N, 0.0E). CONTOUR
C     METHOD CONICON IS USED.
C
      CALL PSETR ('SUBPAGE_MAP_CENTRE_LATITUDE',52.0)
      CALL PSETR ('SUBPAGE_MAP_CENTRE_LONGITUDE',0.0)
      CALL PSETR ('SUBPAGE_MAP_SCALE',55.0E6)
C
      CALL PSETC ('CONTOUR_METHOD','CONICON')
C
C     PLOT THE COASTLINES AND CONTOURS
C
      CALL PCOAST
      CALL PCONT
C
C     PLOT THE TITLE
C
      CALL PSETC ('TEXT_LINE_1',
     1    'Polar Stereographic Northern Hemisphere - MSL Field ')
      CALL PSETI ('TEXT_LINE_COUNT',2)
      CALL PSETC ('TEXT_LINE_2',
     1            'Contouring Method is CONICON')
      CALL PTEXT
C
      RETURN
      END
      SUBROUTINE CONT10_FOUR
C
C     THIS SUBROUTINE PLOTS CONTOUR LINES FOR MSL PRESSURE FIELD ON
C     THE SAME SELECTED EUROPEAN POLAR STEROEGRAPHIC AREA. CONTOUR
C     METHOD LINEAR IS USED.
C
      CALL PSETC ('CONTOUR_METHOD','LINEAR')
C
C     PLOT THE COASTLINES AND CONTOURS
C
      CALL PCOAST
      CALL PCONT
C
C     PLOT THE TEXT
C
      CALL PSETC ('TEXT_LINE_1',
     1    'Polar Stereographic Northern Hemisphere - MSL Field ')
      CALL PSETI ('TEXT_LINE_COUNT',2)
      CALL PSETC ('TEXT_LINE_2',
     1            'Contouring Method is LINEAR')
      CALL PTEXT
C
      RETURN
      END





      SUBROUTINE CONT10_FIVE
C
C     THIS SUBROUTINE PLOTS CONTOUR LINES FOR MSL PRESSURE FIELD ON A
C     POLAR STEREOGRAPHIC PROJECTION OF EUROPEAN REGION. MAP_SCALE IS
C     25.0E6, CONTOUR METHOD IS CONICON AND CONTOUR INTERVAL IS 3.0.
C
      CALL PSETC ('CONTOUR_METHOD','CONICON')
      CALL PSETR ('CONTOUR_INTERVAL',3.0)
C
      CALL PSETR ('SUBPAGE_MAP_SCALE',25.0E6)
C
C     PLOT THE COASTLINES AND CONTOURS
C
      CALL PCOAST
      CALL PCONT
C
C     PLOT THE TEXT
C
      CALL PSETC ('TEXT_LINE_1',
     1    'Polar Stereographic Northern Hemisphere - MSL Field ')
      CALL PSETI ('TEXT_LINE_COUNT',2)
      CALL PSETC ('TEXT_LINE_2',
     1            'Contouring Method is CONICON')
      CALL PTEXT
C
      RETURN
      END
      SUBROUTINE CONT10_SIX                    
C
C     THIS SUBROUTINE PLOTS CONTOUR LINES FOR MSL PRESSURE FIELD ON A
C     SELECTED POLAR STEREOGRAPHIC PROJECTION OF EUROPEAN REGION.
C     CONTOUR METHOD LINEAR IS USED.
C
      CALL PSETC ('CONTOUR_METHOD','LINEAR')
C
C     PLOT THE COASTLINES AND CONTOURS
C
      CALL PCOAST
      CALL PCONT
C
C     PLOT THE TEXT
C
      CALL PSETC ('TEXT_LINE_1',
     1    'Polar Stereographic Northern Hemisphere - MSL Field ')
      CALL PSETI ('TEXT_LINE_COUNT',2)
      CALL PSETC ('TEXT_LINE_2',
     1            'Contouring Method is LINEAR')

      CALL PTEXT
C
      RETURN
      END
