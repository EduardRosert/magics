#!/usr/bin/env python

from distutils.core import setup, Extension
import os
import sys

import numpy
# Obtain the numpy include directory.  This logic works across numpy versions.
try:
    numpy_include = numpy.get_include()
except AttributeError:
    numpy_include = numpy.get_numpy_include()


attdict = dict(
   sources               = ['Magics/Magics.i'],
   swig_opts             = ['-c++'],
   include_dirs          = ['.', '@CMAKE_CURRENT_SOURCE_DIR@/../src/common',numpy_include],
   library_dirs          = ["@CMAKE_BINARY_DIR@/lib","@ECCODES_PATH@/lib"] + ["%s/lib" % sys.prefix],
   libraries             = ["MagPlus","m"],
   runtime_library_dirs  = ["@prefix@/lib"],
   extra_objects         = [],
   extra_link_args       = ['-Wl,-rpath,@CMAKE_INSTALL_PREFIX@/lib']
)

setup (name         = 'Magics',
       version      = '@MAGICS_VERSION_STR@',
       author       = 'ECMWF',
       author_email = 'Software.Support@ecmwf.int',
       description  = """Magics Python interface""",
       license      = 'Apache License, Version 2.0',
       url          = 'https://software.ecmwf.int/Magics',
       ext_modules  = [Extension('Magics._Magics',**attdict)],
       packages     = ['Magics'],
      )
