#!/bin/csh
#
# File: $ECMWFHOME/use/use.magics
#
# Purpose: Set the environment for the test version of MAGICS
#
# Authors: Ditlef Martens
#          Jean-Philippe Martin-Flatin
#          Petra Kogel
#
# $Revision: 1.5 $    $Date: 2004/03/05 09:07:58 $
#
################################################################################

#
# Check if magics is not already selected
#
set version=current

if ($?envSelected == 0) setenv envSelected ""

#echo $envSelected | grep ${version}magics > /dev/null
#if ($status == 0) then
#      echo "magics is already enabled"

#else
   setenv MAG_HOME /usr/local/apps/Magics/${version}
   set maglib = $MAG_HOME/lib
   
   setenv MAG_LOGGING on
   
   # Set MAGLIB
   
   switch ($ARCH)
   	case hppa: 
   		setenv MAGLIB "-L/usr/local/lib,-lmag,-lfgks,-ldgks,-lcgks" 
		echo \$MAGLIB changed to $MAGLIB
   		breaksw
   
   	case linux:
   		setenv MAGLIB "-L${maglib} -lmagics -lMvDevices -lmagics -lgd -lpng -ljpeg -lz -lfreetype -L/usr/local/apps/newgnu/lib -lstdc++ -lm"
		echo \$MAGLIB changed to $MAGLIB
		setenv LD_LIBRARY_PATH /usr/local/apps/newgnu/lib 
		echo \$LD_LIBRARY_PATH changed to $LD_LIBRARY_PATH
   		setenv EMOSLIB "-L/usr/local/lib -lemos"
		echo \$EMOSLIB changed to $EMOSLIB
		setenv LM_LICENSE_FILE /usr/local/apps/pgi/license.dat:${LM_LICENSE_FILE}
		echo \$LM_LICENSE_FILE changed to $LM_LICENSE_FILE
		setenv PATH /usr/local/apps/newgnu/bin:$PGI/linux86/bin:$PATH 
		echo \$PATH changed to $PATH
   		breaksw
   
   	case sgimips:
   		setenv MAGLIB "-L/usr/local/apps/Magics/${version}/lib -lmagGL  -lMvDevices -lftn -lfortran -lm"
		echo \$MAGLIB changed to $MAGLIB
   		setenv LD_LIBRARYN32_PATH /usr/local/apps/Magics/${version}/lib:$LD_LIBRARYN32_PATH
		echo \$LD_LIBRARYN32_PATH changed to $LD_LIBRARYN32_PATH
   		breaksw
   
   	case rs6000:
   		setenv MAGLIB "-L${maglib} -lmagics -lMvDevices -lgd -lpng -ljpeg -lz -lfreetype -lxlf90"
		echo \$MAGLIB changed to $MAGLIB
		#setenv EMOSLIB "-L/usr/local/lib -lemos.new.R32.D64.I32"
		#echo \$EMOSLIB changed to $EMOSLIB   
   endsw
   
   #
   # Mark environment newmagics as read
   #
   setenv envSelected "${version}magics $envSelected"
#endif

unset is_set
